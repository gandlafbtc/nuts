NUT-13: Deterministic secrets and recovery from seed phrase
==========================

`optional` `author: calle` `author: gandlaf`

---

## Description

NUT-13 describes how we can chose the secrets and blinding factors deterministically and thus make ecash recoverable with only the seed phrase (mnemonic) and the mints help/list of signatures provided on blinded messages.

## General flow

### Creating recoverable ecash

**The wallet**
1. Wallet creates a randomly generated bip39 mnemonic phrase
1. Wallet creates a seed key from mnemonic
1. The wallet can now choose the secrets and blinding factors deterministically from the seed with a bip32 derivation scheme:
    * ```m/129372'/0'/${keysetID}'/${counter}'/0'``` for secrets
    * ```m/129372'/0'/${keysetID}'/${counter}'/1'``` for blinding factors
1. The counter must be increased after successfully creating a proof

**The mint**
1. the mint must keep track of which blinded signatures it provided for which blinded message

### Restoring recoverable ecash

**The wallet**
1. The mnemonic must be provided to the wallet
1. Wallet creates a seed key from mnemonic
1. Wallet regenerates `n` blinded messages with the same strategy as above
1. blinded messages get matched against the mints database (locally, for better privacy | at mint, for less bandwidth)
1. Ecash can be restored if:
    * Entries with a signature for blinded messages can be found
1. If a signature is found, we can use the secret and the blinding factor from the corresponding blinded message to recreate the ecash
1. The ecash is valid if:
    * the unblinded signature/secret is not in the spent database

## Example


